this is pseudo code 2 by Lbranch